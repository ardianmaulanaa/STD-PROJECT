CPP

#include <iostream>
#include "header_MLL.h"
using namespace std;

// #Greetings
void welcomePage(){
    cout << endl<< "===================================================" << endl;
    cout << "      SELAMAT DATANG DI MANAJEMEN KOLEKSI    " << endl;
    cout << "                GAME                  " << endl;
    cout << "===================================================" << endl;
};

void fiturPage(){
    cout << "              MENU FITUR                " << endl;
    cout << "===================================================" << endl;
    cout << "1. Masukkan Data Game" << endl;
    cout << "2. Masukkan Data Achievement" << endl;
    cout << "3. Lihat List Game & Achievement" << endl;
    cout << "4. Hapus Data Game" << endl;
    cout << "5. Hapus Data Achievement" << endl;
    cout << "6. Update Data Game" << endl;
    cout << "7. Update Nama Achievement" << endl;
    cout << "8. Cari Game" << endl;
    cout << "9. Cari Achievement" << endl;
    cout << "10. Urutkan Judul Game (A-Z)" << endl;
    cout << "11. Urutkan Game berdasarkan Jumlah Achievement" << endl;
    cout << "12. Total Game berdasarkan Genre" << endl;
    cout << "13. Total Game berdasarkan Platform" << endl;
    cout << "14. Total Achievement" << endl;
    cout << "15. Game dengan Achievment Terbanyak" << endl;
    cout << "16. Game dengan Achievment Tersedikit" << endl;
    cout << ". Keluar" << endl;
    cout << "===================================================" << endl;
};

void closeCMD(){
    cout << endl<< "===================================================" << endl;
    cout << "      TERIMAKASIH SUDAH MENGAKSES MANAJEMEN KOLEKSI    " << endl;
    cout << "                GAME                  " << endl;
    cout << "===================================================" << endl<<endl;

};

// Eksekusi?

void executeOpsi(ListGame &L, int opsi) {

    string id, title, genre, platform;
    string oldTitle, newTitle;
    string achievementName, oldName, newName;

    if (opsi == 1) {
        cout << "ID Game   : "; cin >> id;
        cout << "Judul     : "; cin >> title;
        cout << "Genre     : "; cin >> genre;
        cout << "Platform  : "; cin >> platform;

        if (!isGameExists(L, title)) {
            addGame(L, createElmGame(id, title, genre, platform));
            cout << "Game berhasil ditambahkan\n";
        } else {
            cout << "Game sudah ada\n";
        }
    }

    else if (opsi == 2) {
        cout << "Judul Game       : "; cin >> title;
        cout << "Nama Achievement : "; cin >> achievementName;

        adrGame p = L.first;
        while (p != nullptr && p->info.title != title) {

            if (p != nullptr) {
                addAchievement(p, createElmAchievement(achievementName));
                cout << "Achievement berhasil ditambahkan\n";
            } else {
                cout << "Game tidak ditemukan\n";
            }
            p = p->next;
        }
    }

    else if (opsi == 3) {
        displayListGame(L);
    }

    else if (opsi == 4) {
        cout << "Judul     : "; cin >> title;
        cout << "Genre     : "; cin >> genre;
        cout << "Platform  : "; cin >> platform;

        deleteGameByTitle(L, title, genre, platform);
        cout << "Game dihapus\n";
    }

    else if (opsi == 5) {
        cout << "Nama Achievement : "; cin >> achievementName;
        deleteAchievementsByAchievementName(L, achievementName);
        cout << "Achievement dihapus\n";
    }

    else if (opsi == 6) {
        cout << "Judul Lama : "; cin >> oldTitle;
        cout << "ID Baru    : "; cin >> id;
        cout << "Judul Baru : "; cin >> newTitle;
        cout << "Genre Baru : "; cin >> genre;
        cout << "Platform   : "; cin >> platform;

        updateGame(L, oldTitle, id, newTitle, genre, platform);
        cout << "Data game diperbarui\n";
    }

    else if (opsi == 7) {
        cout << "Judul Game     : "; cin >> title;
        cout << "Nama Lama ACV  : "; cin >> oldName;
        cout << "Nama Baru ACV  : "; cin >> newName;

        updateAchievementName(L, title, oldName, newName);
        cout << "Nama achievement diperbarui\n";
    }

    else if (opsi == 8) {
        cout << "Judul     : "; cin >> title;
        cout << "Genre     : "; cin >> genre;
        cout << "Platform  : "; cin >> platform;

        adrGame p = searchGame(L, title, genre, platform);
        if (p != nullptr) {
            cout << "Game ditemukan:\n";
            cout << p->info.title << endl;
        } else {
            cout << "Game tidak ditemukan\n";
        }
    }

    else if (opsi == 9) {
        cout << "Judul Game : "; cin >> title;

        adrGame p = L.first;
        for (; p != nullptr && p->info.title != title; p = p->next) {}

        if (p != nullptr) {
            adrAchievement q = p->firstACV;
            if (q == nullptr) {
                cout << "Belum ada achievement\n";
            } else {
                while (q != nullptr) {
                    cout << "- " << q->info.achievementName << endl;
                    q = q->next;
                }
            }
        } else {
            cout << "Game tidak ditemukan\n";
        }
    }

    else if (opsi == 10) {
        sortGameByTitle(L);
        cout << "Game diurutkan berdasarkan judul (A-Z)\n";
    }

    else if (opsi == 11) {
        sortGameByAchievementCount(L);
        cout << "Game diurutkan berdasarkan jumlah achievement\n";
    }

    else if (opsi == 12) {
        cout << "Genre : "; cin >> genre;
        cout << "Total game: " << countGameByGenre(L, genre) << endl;
    }

    else if (opsi == 13) {
        cout << "Platform : "; cin >> platform;
        cout << "Total game: " << countGameByPlatform(L, platform) << endl;
    }

    else if (opsi == 14) {
        cout << "Judul Game : "; cin >> title;

        adrGame p = L.first;
        for (; p != nullptr && p->info.title != title; p = p->next) {}

        if (p != nullptr) {
            cout << "Total achievement: "
                 << countAchievement(p->firstACV) << endl;
        } else {
            cout << "Game tidak ditemukan\n";
        }
    }

    else if (opsi == 15) {
        adrGame p = getGameWithMaxAchievement(L);
        if (p != nullptr) {
            cout << "Game dengan achievement terbanyak: "
                 << p->info.title << endl;
        }
    }

    else if (opsi == 16) {
        adrGame p = getGameWithMinAchievement(L);
        if (p != nullptr) {
            cout << "Game dengan achievement tersedikit: "
                 << p->info.title << endl;
        }
    }

    else {
        cout << "Menu tidak valid\n";
    }

    cout << "\nMasukkan angka apa saja lalu ENTER untuk lanjut: ";
    cin >> opsi; // pause sederhana TANPA get / ignore
}


// Masukkan Data Game
// Create
void createListGame(ListGame &L) {
    L.first = nullptr;
    L.last = nullptr;
}
bool isEmptyGame(ListGame L) {
    return (L.first == nullptr && L.last == nullptr);
}
bool isEmptyAchievement(adrGame p) {
    return (p->firstACV == nullptr);
}

bool isGameExists(ListGame L, string judulGame) {
    adrGame p = L.first;
    while(p!= nullptr){
        if(p->info.title == judulGame){
            return true;
        }
        p=p->next;
    }
    return false;
};

adrGame createElmGame(string GameID, string title, string genre, string platform) {
    adrGame p = new elmGame;

    p->info.GameID = GameID;
    p->info.title = title;
    p->info.genre = genre;
    p->info.platform = platform;
    p->firstACV = nullptr;
    p->next = nullptr;
    p->prev = nullptr;

    return p;

}

adrAchievement createElmAchievement(string achievementName) {
    adrAchievement q = new elmAchievement;

    q->info.achievementName = achievementName;

    q->next = nullptr;
    q->prev = nullptr;

    return q;
}

//Add
// Masukkan data Game dan Achievement
void addGame(ListGame &L, adrGame p) {
    if(isEmptyGame(L)) {
        L.first = p;
        L.last = p;
        p->next = nullptr;
        p->prev = nullptr;
    } else {
        L.last->next = p;
        p->prev = L.last;
        p->next = nullptr;
        p->prev = nullptr;
        L.last = p;
    }
    p->next = nullptr;
}

void addAchievement(adrGame &q, adrAchievement p) {
    if (isEmptyAchievement(q)) {
        q->firstACV = p;
        p->next = nullptr;
        p->prev = nullptr;
    } else {
        adrAchievement x = q->firstACV;
        while (x->next != nullptr) {
            x = x->next;
        }
        x->next = p;
        p->prev = x;
        p->next = nullptr;
    }
}
//end input data Game dan Achievement








// Display

// Lihat List Game & Achievement

void displayListGame(ListGame L) {
    adrGame p = L.first;
    cout << endl;
    cout << "===================[LIST GAME]====================" << endl;
    while (p != nullptr) {
        cout << "ID Game                : ";
        cout << p->info.GameID << endl;
        cout << "Judul Game             : ";
        cout << p->info.title << endl;
        cout << "Genre                  : ";
        cout << p->info.genre << endl;
        cout << "Platform               : ";
        cout << p->info.platform << endl;


        adrAchievement q = p->firstACV;
        if (q == nullptr) {
            cout << "Achievements           : (Belum ada achievement)" << endl;
        } else {
            cout << "Achievements           : " << endl;
            while (q != nullptr) {
                cout << "   - " << q->info.achievementName << endl;
                q = q->next;
            }
        }

        p = p->next;
        cout << endl;
    }
}

// End Display








// Delete

// Hapus data Game

void deleteGameByTitle(ListGame &L, string title, string genre, string platform) {

    if (!isEmptyGame(L)) {
        adrGame p = searchGame(L, title, genre, platform);
        if (p != nullptr) {

            if (p == L.first && p == L.last) {
                L.first = nullptr;
                L.last  = nullptr;
            }
            else if (p == L.first) {
                L.first = p->next;
                L.first->prev = nullptr;
            }
            else if (p == L.last) {
                L.last = p->prev;
                L.last->next = nullptr;
            }
            else {
                p->prev->next = p->next;
                p->next->prev = p->prev;
            }

            p->next = nullptr;
            p->prev = nullptr;
        }
    }
}

// Hapus data Achievement

void deleteAchievementsByAchievementName(ListGame &L, string achievementName) {

    if (!isEmptyGame(L)) {

        adrGame p = L.first;

        while (p != nullptr) {

            adrAchievement q = p->firstACV;

            while (q != nullptr) {
                if (q->info.achievementName == achievementName) {
                    adrAchievement nextNode = q->next;
                    if (q == p->firstACV) {
                        p->firstACV = q->next;
                        if (p->firstACV != nullptr) {
                            p->firstACV->prev = nullptr;
                        }
                    }
                    else if (q->next == nullptr) {
                        q->prev->next = nullptr;
                    }
                    else {
                        q->prev->next = q->next;
                        q->next->prev = q->prev;
                    }

                    q->next = nullptr;
                    q->prev = nullptr;

                    q = nextNode;
                }
                else {
                    q = q->next;
                }
            }
            p = p->next;
        }
    }
}

// End Delete







// Update

// Update Data Game

void updateGame(ListGame &L, string oldTitle, string newGameID, string newTitle, string newGenre, string newPlatform) {
    adrGame p = L.first;

    while (p != nullptr) {
        if (p->info.title == oldTitle) {
            p->info.GameID   = newGameID;
            p->info.title    = newTitle;
            p->info.genre    = newGenre;
            p->info.platform = newPlatform;
        }
        p = p->next;
    }
}

// Update Nama Achievement

void updateAchievementName(ListGame &L, string &title, string &oldName, string &newName) {
  adrGame p = L.first;

    while (p != nullptr) {
        if (p->info.title == title) {
            adrAchievement q = p->firstACV;
            while (q != nullptr) {
                if (q->info.achievementName == oldName) {
                    q->info.achievementName == newName;
                }
                q = q->next;
            }
        }
        p = p->next;
    }
}

// End Update








// Search

// Cari Game

adrGame searchGame(ListGame L, string title, string genre, string platform) {
    adrGame p;
    p = L.first;
    while (p != nullptr) {
        if(p->info.title == title && p->info.genre == genre && p->info.platform == platform) {
            return p;
        }
        p = p->next;
    }
    return nullptr;
}

// Cari Achievement

adrAchievement searchAchievement(adrGame p, string achievementName) {
    if (p->firstACV != nullptr){
        adrAchievement q = p->firstACV;
        while(q != nullptr) {
            if(q->info.achievementName == achievementName) {
                return q;
            }
            q = q->next;
        }
    }
    return nullptr;
}

// End Search








//Sorting

// Urutkan Judul Game (A-Z)

void sortGameByTitle(ListGame &L) {
    adrGame p, t;

    p = L.first;
    while (p != nullptr) {
        t = p->next;
        while (t != nullptr) {
            if (p->info.title > t->info.title) {

                Game tempGame = p->info;
                adrAchievement tempACV = p->firstACV;

                p->info = t->info;
                p->firstACV = t->firstACV;

                t->info = tempGame;
                t->firstACV = tempACV;
            }
            t = t->next;
        }
        p = p->next;
    }
}

// Urutkan Game berdasarkan Jumlah Achievement

void sortGameByAchievementCount(ListGame &L) {
    adrGame p, a;

    p = L.first;
    while (p != nullptr) {
        a = p->next;

        while (a != nullptr) {
            if (countAchievement(p->firstACV) < countAchievement(a->firstACV)) {

                Game tempGame = p->info;
                adrAchievement tempACV = p->firstACV;

                p->info = a->info;
                p->firstACV = a->firstACV;

                a->info = tempGame;
                a->firstACV = tempACV;
            }
            a = a->next;
        }
        p = p->next;
    }
}

// End Sorting






// Count

// Total Game Berdasarkan Genre

int countGameByGenre(ListGame L, string genre) {
    int count = 0;
    adrGame p = L.first;

    while (p != nullptr) {
        if (p->info.genre == genre) {
            count++;
        }
        p = p->next;
    }
    return count;
}

//Total Game Berdasarkan Platform
int countGameByPlatform(ListGame L, string platform) {
    int count = 0;
    adrGame p = L.first;

    while (p != nullptr) {
        if (p->info.platform == platform) {
            count++;
        }
        p = p->next;
    }
    return count;
}


// Total Achievement

int countAchievement(adrAchievement firstACV) {
    int count = 0;
    adrAchievement p = firstACV;

    while(p != nullptr) {
        count++;
        p=p->next;
    }
    return count;
}


// End Count







// Get atau MIN/MAX

// Game dengan Achievment Terbanyak

adrGame getGameWithMaxAchievement(ListGame L) {
    if (isEmptyGame(L)) {
        return nullptr;
    }
    adrGame p = L.first;
    adrGame maxGame = p;
    int maxCount = countAchievement(p->firstACV);

    while (p != nullptr) {
        int currentCount = countAchievement(p->firstACV);
        if (currentCount > maxCount) {
                maxCount = currentCount;
                maxGame = p;
            }
        p=p->next;

        }
    return maxGame;
}

// Game dengan Achievment Tersedikit

adrGame getGameWithMinAchievement(ListGame L) {
    if (isEmptyGame(L)) {
        return nullptr;
    }
    adrGame p = L.first;
    adrGame minGame = p;
    int minCount = countAchievement(p->firstACV);

    while (p != nullptr) {
        int currentCount = countAchievement(p->firstACV);
        if (currentCount < minCount) {
                minCount = currentCount;
                minGame = p;
            }
        p=p->next;

        }
    return minGame;
}

// End Min/Max





//Utility

void clearScreen() {
    system("cls"); //Hanya bisa untuk windows
}

// End Ultility





