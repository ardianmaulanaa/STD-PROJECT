CPP
#include <iostream>
#include "Tubes_MLL.h"
using namespace std;

void createListGame(ListGame &L) {
    L.first = nullptr;
    L.last = nullptr;
}

bool isEmptyGame(ListGame L) {
    return (L.first == nullptr);
}

bool isEmptyAchievement(adrGame p) {
    return (p->firstACV == nullptr);
}

adrGame createElmGame(string GameID, string title, string genre, string platform) {
    adrGame p = new elmGame;
    p->info.GameID = GameID;
    p->info.title = title;
    p->info.genre = genre;
    p->info.platform = platform;
    p->next = nullptr;
    p->prev = nullptr;
    return p;
}

adrAchievement createElmAchievement(string achievementName) {
    adrAchievement q = new elmAchievement;
    q->info.achievementName = achievementName;
    q->next = nullptr;
    q->prev= nullptr;
    return q;
}

void addGame(ListGame &L, adrGame p) {
    if (isEmptyGame(L)) {
        L.first = p;
        L.last = p;
    } else {
        L.last->next = p;
        p->prev = L.last;
        L.last = p;
    }
}

void addAchievement(adrGame &p, adrAchievement q) {
    adrAchievement x;
    if (p->firstACV == nullptr) {
        p->firstACV = q;
    } else {
        x = p->firstACV;
        while (x->next != nullptr) {
            x = x->next;
        }
        x->next = q;
        q->prev = x;
    }
}

adrGame searchGame(ListGame L, string title, string genre, string platform) {
    adrGame p;
    p = L.first;
    while (p != nullptr) {
        if(p->info.title == title && p->info.genre == genre && p->info.platform == platform) {
            return p;
        }
        p = p->next;
    }
    return nullptr;
}

void deleteGameByTitle(ListGame &L, string title) {
    adrGame p = L.first;

    while (p != nullptr) {

        if (p->info.title == title) {
            adrGame nextParent = p->next;
            if (p == L.first) {
                L.first = p->next;
                if (L.first != nullptr) {
                    L.first->prev = nullptr;
                }
            } else if (p == L.last) {
                L.last = p->prev;
                if (L.last != nullptr) {
                    L.last->next = nullptr;
                }
            } else {
                p->prev->next = p->next;
                p->next->prev = p->prev;
            }
            p = nextParent;
        } else {
            p = p->next;
        }
    }
}

void deleteAchievementsByAchievementName(ListGame &L, string achievementName) {
    adrGame p = L.first;

    while (p != nullptr) {
        adrAchievement q = p->firstACV;
        while (q != nullptr) {
            if (q->info.achievementName == achievementName) {
                adrAchievement nextChild = q->next;
                if (q == p->firstACV) {
                    p->firstACV = q->next;
                    if (p->firstACV != nullptr) {
                        p->firstACV->prev = nullptr;
                    }
                } else if (q->next == nullptr) {
                    q->prev->next = nullptr;
                } else {
                    q->prev->next = q->next;
                    q->next->prev = q->prev;
                }
                q = nextChild;
            } else {
                q = q->next;
            }
        }
        p = p->next;
    }
}

void updateGameAddAchievement(ListGame &L, string &title, string &newAchievementName) {
    adrGame p = L.first;

    while (p != nullptr) {
        if (p->info.title == title) {
            adrAchievement newNode = createElmAchievement(newAchievementName);
            addAchievement(p, newNode);
        }
        p = p->next;
    }
}

void updateAchievementName(ListGame &L, string &title, string &oldName, string &newName) {
    adrGame p = L.first;

    while (p != nullptr) {
        if (p->info.title == title) {
            adrAchievement q = p->firstACV;
            while (q != nullptr) {
                if (q->info.achievementName == oldName) {
                    q->info.achievementName = newName;
                }
                q = q->next;
            }
        }
        p = p->next;
    }
}

